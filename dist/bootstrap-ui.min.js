(function(i){var c={exports:i,name:"$bui"};var k=function(o,n){return this[o].apply(this,Array.slice.call(arguments,1))};function g(o,r){function n(){if(s.init){s.init();delete s.init}var w;if(this.__proto__==$.fn){w=this
}else{w=$("<div/>")}w.addClass(s.containerClass?" bui-"+s.containerClass:"");w.data("bui",o.toLowerCase());w.data("_bui",w);w.large=function(){if(w.hasClass("bui-"+s.containerClass+"-sm")){w.removeClass("bui-"+s.containerClass+"-sm")
}w.addClass("bui-"+s.containerClass+"-lg");return w};w.small=function(){if(w.hasClass("bui-"+s.containerClass+"-lg")){w.removeClass("bui-"+s.containerClass+"-lg")}w.addClass("bui-"+s.containerClass+"-sm");
return w};if(s.proxyInput){f(w,"attr")("name",function(x){w.$input.attr("name",x)},function(){return w.$input.attr("name")});w.val=function(x){if(arguments.length<1){x=w.$input.val();return w.$input.getValue?w.$input.getValue(x):x
}else{if(w.$input.setValue){x=w.$input.setValue(x);if(x===false){return this}}w.$input.val(x);return this}}}j(w);var u;for(var p in q){u=f(w,p);for(var v in q[p]){u(v,q[p][v]["set"],q[p][v]["get"])}}for(p in t){w[p]=t[p]
}r.apply(w,arguments);if(s.proxyInput&&!w.$input){throw new Error("目标输入域没有定义（$bui."+o+".$input）")}return w}var q={};var t={};var s=n;s.containerClass=o.toLowerCase();s.hook=function(v,u,p,w){if(!q[v]){q[v]={}
}if(!q[v][u]){q[v][u]={}}q[v][u][p]=w;return this};s.proxy=function(u,p){t[u]=p;return this};return s}k.plugin=g;function l(n,o){return n.trigger("change",Array.prototype.slice.call(arguments,1))}function f(p,n){if($.fn[n]&&!p[n]){if(i.JS_DEBUG){console.error(p)
}throw new Error(" * 参数不是jquery对象。")}if($.fn[n]!=p[n]){return p[n].handle}function o(r,q,t){var s="_"+q;var u=t===undefined;if(p[n].handle[s]!==undefined&&p[n].handle[s][u?"get":"set"]!==undefined){if(u){t=p[n].handle[s].get.call(p);
if(t!==undefined){return t}}else{t=p[n].handle[s].set.call(p,t);if(t===undefined){return false}}}return $.fn[n].apply(p,Array.prototype.slice.call(arguments,1))}p[n]=function(q,r){return jQuery.access(this,o,q,r,false)
};p[n].handle=function(r,u,q){if(typeof r==="object"){for(var t in r){p[n].handle(t,r[t].set,r[t].get)}}var s="_"+r;if(!p[n].handle[s]){p[n].handle[s]={}}if(u){p[n].handle[s].set=u}if(q){p[n].handle[s].get=q
}return p[n].handle[s]};return p[n].handle}function j(n){$.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(o,p){n[o]=function(q){var r=$(q);
if(r.length==0){return this}$(r[0])[p](this);return this}})}c.exports[c.name]=k;(function(p){var o=p.Button=g("Button",n);o.hook("attr","text","get",function(){this._text();return false});o.hook("attr","text","set",function(q){this._text(q)
});o.hook("attr","type","get",function(){return this.ctype});o.hook("attr","type","set",function(q){if(this.ctype){this.self.removeClass("btn-"+this.ctype)}this.self.addClass("btn-"+q);this.ctype=q});function n(r,u,s){var t=this;
var q;switch(u){case"submit":q=$('<input class="btn"/>').attr("type","submit");break;case"input":q=$('<input class="btn"/>').attr("type","button");break;case"button":t=$('<button class="btn"/>').appendTo(this);
this._text=function(v){q.val(v)};break;default:this.addClass("btn")}if(q){this.append(q);this.self=q;this._text=function(v){if(v===undefined){q.val()}else{q.val(v)}}}else{this.self=t;this._text=function(v){if(v===undefined){return t.text()
}else{return t.empty().append(v)}}}if(!s){s="default"}this.attr({type:s,text:r,"data-style":u})}})(k);(function(o){var p=o.CheckBox=g("CheckBox",n);p.proxyInput=true;p.hook("attr","label","set",function(q){this.$text.text(q)
});p.hook("attr","label","get",function(){return this.$text.text()});function n(r){var q=$("<label>").appendTo(this);$('<span class="checkbox-show">').appendTo(q).html('<span class="ico"/>');this.$input=$("<input/>").val("false").attr("type","hidden").appendTo(q);
this.$text=$('<span class="checkbox-title"/>').appendTo(q);this.addClass("checkbox");var s=false;this.$input.setValue=function(u){s=b(u);t[(s?"add":"remove")+"Class"]("active");return s?"true":"false"};
this.$input.getValue=function(){return s};var t=this;this.click(function(){t.val(!s);l(t,s);return false});if(r){this.attr("label",r)}}})(k);(function(r){var p=/^warning|success|error$/i;var o=r.FormControl=g("FormControl",n);
o.proxyInput=true;function q(s){var t=s.data("bui");if(t=="button"){}else{if(t=="icon"){s=$('<span class="bui-icon-outer"/>').append(s)}else{if(s.filter("input:not(:button,:submit)").length){s.addClass("form-control")
}else{if(s.filter("span,a").length){s.addClass("bui-icon-outer")}}}}return s}function n(){var w=this;var u=$('<div class="center-widget"/>').appendTo(w);w.$input=$('<input class="form-control"/>').attr("type","text").appendTo(u);
var s,t;w.addClass("input-group");var v=false;w.centerWidget=function(y){if(arguments.length==1){if(v){v.remove();v=null}if(y.attr("type")=="hidden"){v=$('<input class="form-control"/>').attr({disabled:"disabled",type:"text"}).val(y.attr("title"));
w.$input.replaceWith(v);y.insertAfter(v)}else{if(!y.hasClass("bui-formcontrol")){y.addClass("form-control")}w.$input.replaceWith(y)}w.$input=y}return w.$input};var x="";w.alert=function(y){if(x==y){return
}w.removeClass("alert-"+x);if(p.test(y)){w.addClass("alert-"+y.toLowerCase());x=y}else{x=""}};w.append=function(y){if(!t){t=$('<div class="input-group-btn btn-group bui-append"/>');$.fn.append.call(w,t)
}y=q(y);y.appendTo(t);return y};w.prepend=function(y){if(!s){s=$('<div class="input-group-btn bui-prepend"/>');$.fn.prepend.call(w,s)}y=q(y);return y.prependTo(s)}}})(k);(function(p){var n=p.Gravatar=g("Gravatar",o);
n.hook("attr","hash","set",function(r){this._gravatar.hash=r;this._reset();return r});n.hook("attr","size","set",function(r){this._gravatar.size=r;this._reset();return r});n["default"]="identicon";function q(t){var r="http://www.gravatar.com/avatar/";
r+=t.hash;r+="."+(t.type?t.type:"png");r+="?";r+="s="+t.size;if(t.rating){r+="&r="+t.rating}var s=t["default"]||n["default"];if(/^https?:\/\//i.test(s)){r+="&d="+encodeURIComponent(s)}else{if(/[0-9a-z]{32}/i.test(s)){r+="&d="+encodeURIComponent("http://www.gravatar.com/avatar/"+s+".png")
}else{if(s){r+="&d="+s}}}return r}n.build=q;function o(r,s){this.addClass("gravatar");this._gravatar={};this._reset=function(){var t=q(this._gravatar);this.css({backgroundImage:"url("+t+")",height:this._gravatar.size,width:this._gravatar.size})
};this.attr({size:r,hash:s})}})(k);function h(p){var n;var o=typeof p;if(o==="boolean"){return +p}else{if(o==="string"){n=parseFloat(p);return(isNaN(n)||!isFinite(n))?0:n}else{if(o==="number"&&isFinite(p)){return p|0
}else{return 0}}}}function m(w,o){var q=[],u=[],r=0;var n,s=false;if(typeof w==="string"){n=!(w=="or");r++}else{if(typeof w==="boolean"){n=false;s=w;r++}}if(typeof o==="boolean"){r++;s=o}var v=null;var t=arguments.length;
for(;r<t;r++){if(typeof arguments[r]=="function"){v=arguments[r];continue}if(parseInt(arguments[r])==arguments[r]){u.push(parseInt(arguments[r]))}else{q.push(e(arguments[r]))}}function p(x){if(x<47){return true
}if(90<x&&x<94){return true}if(111<x&&x<146){return true}return false}return function(z){if(z.shiftKey||z.ctrlKey||z.altKey){return v?v.apply(this,arguments):true}if(s){if(p(z.which)){return v?v.apply(this,arguments):true
}}var x=false;for(var y=u.length-1;y>=0;y--){x=u[y]===z.which;if(n&&!x){z.preventDefault();return}else{if(x){return v?v.apply(this,arguments):true}}}for(y=q.length-1;y>=0;y--){x=q[y].test(z.which);if(n&&!x){z.preventDefault();
return}else{if(x){return v?v.apply(this,arguments):true}}}if(x){return v?v.apply(this,arguments):true}z.preventDefault();return}}function e(n){var q=[-Infinity,Infinity],p=[true,true];var o={test:function(r){return(p[0]?q[0]<=r:q[0]<r)&&(p[1]?q[1]>=r:q[1]>r)
},fit:function(r){if((p[0]?q[0]>r:q[0]>=r)){return p[0]?q[0]:q[0]+1}if((p[1]?q[1]<r:q[1]<=r)){return p[1]?q[1]:q[1]-1}return r},toString:function(){return(p[0]?"[":"(")+q[0]+","+q[1]+(p[1]?"]":")")},fromString:function(s){try{if(parseFloat(s)==s){p[1]=p[0]=true;
q[0]=q[1]=parseFloat(s);return o}if(!s){q[0]=-Infinity;q[1]=Infinity;return o}q=s.split(",");p[0]=q[0].substr(0,1)=="[";p[1]=q[1].substr(-1)=="]";q[0]=q[0].substr(1);q[1]=q[1].substr(0,q[1].length-1);q[0]=q[0].length?h(q[0]):-Infinity;
q[1]=q[1].length?h(q[1]):Infinity;return o}catch(r){throw new Error("范围错误："+s)}}};Object.defineProperty(o,"min",{get:function(){return q[0]},set:function(r){return q[0]=r}});Object.defineProperty(o,"max",{get:function(){return q[1]
},set:function(r){return q[1]=r}});Object.defineProperty(o,"left",{get:function(){return p[0]},set:function(r){return p[0]=r}});Object.defineProperty(o,"right",{get:function(){return p[1]},set:function(r){return p[1]=!!r
}});n=$.trim(n);if(n.length){return o.fromString(n)}else{return o}}function b(n){if(typeof n=="string"){n=n.toLowerCase();n=(n=="on")||(n=="yes")}if(typeof n!="boolean"){n=!!n}return n}function d(r,q,o){function p(s){return q.call(r,s)
}r.on("mousedown",p);function n(t){var s=o.call(r,t);r.off("mousedown",p);$(document).off("mouseup",n);return s}$(document).on("mouseup",n)}function a(o,n){if(typeof o=="string"){o=o.toLowerCase();if(o=="left"){o=1
}else{if(o=="right"){o=3}else{if(o=="middle"){o=2}}}}if(typeof o==="function"){n=o;o=1}return function(p){if(p.which!==o){return}n.apply(this,arguments)}}(function(p){var q="adjust,align-center,align-justify,align-left,align-right,arrow-down,arrow-left,arrow-right,arrow-up,asterisk,backward,ban-circle,barcode,bell,bold,book,bookmark,briefcase,bullhorn,calendar,camera,certificate,check,chevron-down,chevron-left,chevron-right,chevron-up,circle-arrow-down,circle-arrow-left,circle-arrow-right,circle-arrow-up,cloud,cloud-download,cloud-upload,cog,collapse-down,collapse-up,comment,compressed,copyright-mark,credit-card,cutlery,dashboard,download,download-alt,earphone,edit,eject,envelope,euro,exclamation-sign,expand,export,eye-close,eye-open,facetime-video,fast-backward,fast-forward,file,film,filter,fire,flag,flash,floppy-disk,floppy-open,floppy-remove,floppy-save,floppy-saved,folder-close,folder-open,font,forward,fullscreen,gbp,gift,glass,globe,hand-down,hand-left,hand-right,hand-up,hd-video,hdd,header,headphones,heart,heart-empty,home,import,inbox,indent-left,indent-right,info-sign,italic,leaf,link,list,list-alt,lock,log-in,log-out,magnet,map-marker,minus,minus-sign,move,music,new-window,off,ok,ok-circle,ok-sign,open,paperclip,pause,pencil,phone,phone-alt,picture,plane,play,play-circle,plus,plus-sign,print,pushpin,qrcode,question-sign,random,record,refresh,registration-mark,remove,remove-circle,remove-sign,repeat,resize-full,resize-horizontal,resize-small,resize-vertical,retweet,road,save,saved,screenshot,sd-video,search,send,share,share-alt,shopping-cart,signal,sort,sort-by-alphabet,sort-by-alphabet-alt,sort-by-attributes,sort-by-attributes-alt,sort-by-order,sort-by-order-alt,sound-5-1,sound-6-1,sound-7-1,sound-dolby,sound-stereo,star,star-empty,stats,step-backward,step-forward,stop,subtitles,tag,tags,tasks,text-height,text-width,th,th-large,th-list,thumbs-down,thumbs-up,time,tint,tower,transfer,trash,tree-conifer,tree-deciduous,unchecked,upload,usd,user,volume-down,volume-off,volume-up,warning-sign,wrench,zoom-in,zoom-out".split(",");
var o=p.Icon=g("Icon",n);o.list=q;o.hook("attr","icon","get",function(){return this.change()});o.hook("attr","icon","set",function(r){this.change(r)});function n(r){this.addClass("glyphicon");var s="";
this.change=function(t){if(!t){return s}if(s){this.removeClass("glyphicon-"+s)}this.addClass("glyphicon-"+t);s=t;return this};if(r){this.change(r)}}})(k);(function(o){var r=o.InputList=g("InputList",n);
r.hook("attr","name","set",function(s){this.$list.find("input").attr("name",s+"[]");return s});function q(u,v,t){var s=$("<li/>");$("<span/>").addClass("bui-label").text(v?v:u).appendTo(s);$("<input/>").attr({type:"hidden",name:t+"[]"}).val(u).appendTo(s);
$("<a/>").addClass("bui-delete").appendTo(s);return s}function p(y,v,s){if(y.constructor!==Array){throw new TypeError("$bui.InputList.val() 参数必须是数组。")}var w=[];var x;for(var u=0,t=y.length;u<t;u++){if(v[y[u]]){x=v[y[u]]
}w[u]=q(y[u],x,s)[0]}return $(w)}function n(){var x=this;var y=[];var t={};var v=$('<ul class="list"/>').appendTo(this);var u=(new o.FormControl()).appendTo($('<div class="control"/>').appendTo(this));
var w=u.centerWidget($("<input/>").attr("type","text"));var s=new o.Button(new o.Icon("plus"));this.$list=v;u.append(s);w.on("keydown",A);this.centerWidget=function(B){w.off("keydown",A);w=u.centerWidget(B);
B.attr("name","");B.on("keydown",A)};this.on("click",".bui-delete",function(D){var B=$(this).prev().val();var C=y.indexOf(B);if(C>-1){y.splice(C,1)}$(this).parent().remove();D.preventDefault()});function A(B){if(B.shiftKey||B.ctrlKey||B.altKey){return
}if(B.which==13){var C=w.val();w.val("").focus();z(C);return false}}this.val=function(B){if(arguments.length==0){return y}else{var C=x.attr("name");y=B;var D=p(B,t,C);D.appendTo(v.empty());return this}};
s.on("click",a("left",function(){var B=w.val();w.val("").focus();z(B)}));this.addVal=z;function z(D,C){if(!D){return false}if(!C){if(t[D]){C=t[D]}}if(x.data("unique")&&y.indexOf(D)>=0){return false}var B=x.attr("name");
q(D,C,B).appendTo(v);y.push(D);l(x,y)}this.mapTitle=function(B,C){if(C===undefined||C){$.extend(t,B)}else{t=B}return this}}})(k);(function(p){var o=p.IntInput=g("IntInput",n);o.hook("attr","range","get",function(){return this.range.toString()
});o.hook("attr","range","set",function(q){this.range.fromString(q);var r=this.val();var s=this.range.fit(r);if(r!=s){this.val(s);l(this,s)}});o.proxyInput=true;function n(q){if(!q){q=""}var v=0;var u=p.FormControl.call(this);
u.val(0);var t=u.range=new e();u.prop("speed",1);var w=u.$input=u.centerWidget().addClass("text-center").attr("type","number").on("keydown",m("or","[96,105]","[48,57]","109","189",function(r){u.removeClass("has-error")
})).change(function(){u.val($(this).val());l(u,u.val())});u.$left=u.prepend(p.Button(new p.Icon("arrow-left"),"span","default"));u.$right=u.append(p.Button(new p.Icon("arrow-right"),"span","default"));
w.setValue=function(x){var r=parseInt(x);if(r==x&&t.test(r)){if(u.hasClass("has-error")){u.removeClass("has-error");return false}v=x;return x}r=t.fit(r);u.addClass("has-error");return r+""};w.getValue=h;
u.attr("range",q);u.alert("");function s(){if(u.pressed){if(u.pressed>50){u.pressed-=Math.round(u.pressed/3)}var r=u.val()+s.dir*u.prop("speed");u.val(r);if(r==v){l(u,r)}s._time=setTimeout(s,u.pressed)
}}u.$left.mousedown(function(x){if(x.which>2){return}u.pressed=500;s.dir=-(1+(x.which-1)*9);s();function r(){clearTimeout(s._time);u.pressed=false;$(document).off("mouseup",r)}$(document).on("mouseup",r)
});u.$right.mousedown(function(){if(event.which>2){return}u.pressed=500;s.dir=1+(event.which-1)*9;s();function r(){clearTimeout(s._time);u.pressed=false;$(document).off("mouseup",r)}$(document).on("mouseup",r)
});u.on("mousewheel","input:focus",function(r,x){u.pressed=1000;s.dir=x;s();u.pressed=false;return false});return u.removeClass("has-error")}})(k);(function(o){var n=function(){var q=this;this.$list={};
this.$select={};this.options=[];if(arguments.length>0){var r=Array.prototype.slice.call(arguments);var t=r.shift();this.name=t.name;this.lines=t.lines;for(var s=0;s<t.options.length;s++){this.options.push(t.options[s])
}u.call(this)}function u(){var B='<ul multiple class="bui-select list-group">';var z="</ul>";var y='<select multiple name="'+this.name+'[]" style="display:none;">';var A="</select>";var w="",v="";for(var x=0;
x<this.options.length;x++){w+=' <option value="'+this.options[x][1]+'">'+this.options[x][0]+"</option>";v+=' <li class="btn  list-group-item bui-select-option">'+this.options[x][0]+"</li>"}q.$list=$(B+v+z).appendTo(q);
q.$select=$(y+w+A).appendTo(q)}this.appendTo=function(v){$.fn.appendTo.call(this,v);this.adjustSize()};this.addItem=function(y,x){var w=new Array(y,x);this.options.push(w);if(this.$list){this.$select.append(' <option value="'+x+'">'+y+"</option>");
this.$list.append(' <li class="btn  list-group-item bui-select-option">'+y+"</li>")}else{this.init()}};this.adjustSize=function(){this.$select.css({height:this.lines*this.$list.find("li").get(0).clientHeight})
}};function p(q){}g("MultiSelect",n,p)})(k);$(document).on("click",".bui-select-option",function(){var p=$(this);var n=p.parent().next();n.focus();n.find("option").eq(p.index()).click();console.log(n);
var o=n.find("option").get(p.index());o.selected=!o.selected;p.toggleClass("btn-primary")});(function(o){var p=o.OneOf=g("OneOf",n);function n(){var u=this;var r=[];var s=[];var t=-1;function q(w){if(!w){return
}var v=s.indexOf(w);if(t===v){return}var x=r[v];l(u,v,w,x);x._item.attr("name",w);x.addClass("active");if(t!=-1){r[t]._item.attr("name","");r[t].removeClass("active")}t=v}this.addItem=function(x){var w=x.attr("name");
if(!w){throw new Error("bui.OneOf.addItem 参数必须是其他bui object，或者有name属性的元素")}x.attr("name","");x.attr("tabindex","-1");var v=$('<div class="line"/>');var y=(new o.Icon("unchecked")).addClass("one_state");
$('<div class="icon"/>').append(y).appendTo(v);$('<div class="control"/>').append(x).appendTo(v);v._item=x;v.appendTo(this);r.push(v);s.push(w);if(t==-1){q(w)}v.on("click",function(){q(w)});x.on("change",function(){q(w)
});return this};this.focus(function(){r[t].focus()})}})(k);$(document).on("shown.bs.tab",function(p){var o=$(p.target);var n=o.closest("ul:not(.dropdown-menu)>.active");if(!n.length){o.addClass("active")
}});(function(n){var o=n.Progress=g("Progress",q);o.hook("attr","progress","set",function(r){this._barlist[0].val(r);return this});o.hook("attr","progress","get",function(){return this._barlist[0].val()
});o.hook("attr","striped","set",function(r){this[r?"addClass":"removeClass"]("progress-striped")});o.hook("attr","striped","get",function(){return this.hasClass("progress-striped")});o.hook("attr","active","set",function(r){this[r?"addClass":"removeClass"]("active")
});o.hook("attr","active","get",function(){return this.hasClass("active")});function q(s){this.addClass("progress");var r=this._barlist=[];this.addBar=function(v,u){var t=new p();if(v){t.alert(v)}if(u){t.alert(u)
}r.push(t);t.appendTo(this);return this};this.getBar=function(t){if(t){return r[t]}else{return r[0]}};this.removeBar=function(t){r.splice(t,1);return this};if(!s){this.addBar("",0)}}function p(){var s=$('<div class="progress-bar" role="progressbar" aria-valuemin="0" aria-valuemax="100"/>',document);
var t=$('<span class="sr-only"/>').appendTo(s);var r=0;s.val=function(u){if(arguments.length){if(u>100){u=100}if(u<0){u=0}r=u;s.css("width",u+"%").attr("aria-valuenow",u);t.text("已经完成百分之"+u)}else{return r
}};s.alert=function(u){if(this._alert_state){this.removeClass(this._alert_state);this._alert_state=""}if(u){this._alert_state="progress-bar-"+u;this.addClass(this._alert_state)}else{this._alert_state=""
}};return s}})(k);(function(o){var n=o.Select=g("Select",s);n.proxyInput=true;n.init=function(){$(document).on("click",p)};n.hook("attr","title","set",function(t){if(this.$input&&!this.$input.val()){this.$show.text(t)
}return t});var r=null;function p(){if(r){r.removeClass("active");r=null}}function q(u,t){return $("<li/>").attr("value",t).append($("<a/>").html(u))}function s(){var u={};var w=this.addClass("form-control btn btn-default");
var t=$('<ul class="dropdown-menu" role="menu"/>');this.addOption=function(y,x){u[x]=y;t.append(q(y,x))};this.find("option").each(function(){w.addOption($(this).val(),$(this).text());$(this).remove()});
t.append(this.children()).appendTo(this);var v=$('<div class="bui-toggle"/>').prependTo(w);w.$show=$("<span/>").appendTo(v);$('<span class="caret"/>').appendTo(v);w.$input=$("<input/>").attr("type","hidden").val("").prependTo(w);
w.$input.setValue=function(x){if(!u.hasOwnProperty(x)){w.$show.text(w.attr("title"));return""}w.$show.text(u[x]);return x};if(!this.attr("title")){this.attr("title","请选择")}w.click(function(){if(w.hasClass("active")){p()
}else{p();r=w.addClass("active")}return false});t.on("click","li",function(){var x=$(this).attr("value");w.$input.val(x);w.$show.text($(this).text());p();l(w,x);return false})}})(k);(function(p){var o=p.Switch=g("Switch",n);
o.proxyInput=true;o.hook("attr","disabled","set",function(r){if(typeof r==="string"){r=r.toLowerCase()=="disabled"}if(r){this.$btn.addClass("disabled");this.addClass("disabled")}else{this.$btn.removeClass("disabled");
this.removeClass("disabled")}this._lock=r;return r});function q(r){r=b(r);$(this)[(r?"add":"remove")+"Class"]("on");if(r){this.$input.removeAttr("disabled")}else{this.$input.attr("disabled","disabled")
}this.current_status=r;return false}function n(s){var w=this;this.current_status=!!s;this.icon=new p.Icon("");this.$input=$("<input/>").val("true").attr("type","hidden").appendTo(this);this.$input.setValue=function(A){A=b(A);
w[(A?"add":"remove")+"Class"]("on");w.current_status=A;return A?"true":"false"};this.$input.getValue=function(){return w.current_status};var u=$("<div/>").addClass("bui-switch-container").appendTo(this);
var x=$('<span class="btn btn-default bui-switch-btn"/>').appendTo(u);var y=$('<div class="bui-switch-mask"/>').appendTo(u);var t=$('<span class="bui-switch-blue"/>');this.$btn=x;var z=false;function v(E){if(w._lock){return
}w.addClass("drag");var A=w.width();var F=E.pageX-parseFloat(x.css("left"));var D=0;$(document).on("mouseup",B);$(document).on("mousemove",C);x.on("mouseleave",r);function C(G){D=G.pageX-F;if(D<=0||D>=A){return
}x.css("left",G.pageX-F);y.css("left",G.pageX-F)}function B(G){if((w.current_status&&D<A/2)||(!w.current_status&&D>A/2)){w.val(!w.current_status);l(w,w.current_status)}x.css("left","");y.css("left","");
w.removeClass("drag");$(document).off("mouseup",B);x.off("mouseleave",r);$(document).off("mousemove",C)}}function r(){z=true}x.on("mousedown",v);this.val(this.current_status);this.on("click",function(){if(z){z=false;
return}if(w._lock){return}w.val(!w.current_status);l(w,w.current_status)})}})(k);(function(o){var n=o.UploadSingle=g("UploadSingle",p);n.proxyInput=true;function p(D){if(typeof D==="string"){D={url:D}}if(!D||!D.url){throw new Error("bui.UploadSingle 构造必须指定一个url")
}D=$.extend({dataType:"json",autoUpload:false,acceptFileTypes:/\.(gif|jpe?g|png)$/i,maxFileSize:3000000,disableImageResize:/Android(?!.*Chrome)|Opera/.test(i.navigator.userAgent),previewMaxWidth:100,previewMaxHeight:100,maxChunkSize:undefined,multipart:true,previewCrop:true,current:null,formData:function(){return[]
}},D);var I=(new o.FormControl()).appendTo(this);var H=D.current;var z=this;this.$input=$('<input style="display: none!important;"/>').attr("type","text").appendTo(this);this.$input.getValue=function(){return H
};this.$input.setValue=function(K){return H=K};var t=I.centerWidget($("<input/>").attr("type","file"));var y=new o.Progress();y.getBar().attr({progress:0,striped:true,active:true});y.css({width:"200px"});
I.append(y);var F=$("<span/>").append(new o.Icon("eye-open"));var C=$('<div><img width="100" height="100"/><div style="width:100px;height:100px;text-align:center;">无</div></div>');I.prepend(F);F.popover({html:true,title:"当前图片",content:function(){C.find("img").attr("src",H);
if(H){C.find("img").show();C.find("div").hide()}else{C.find("img").hide();C.find("div").show()}return C},placement:"auto",trigger:"hover"});var x="";var B=$('<div><div style="width:100px;height:100px;text-align:center;">没有选中</div></div>');
var G=t.parent().popover({html:true,title:"选中的图像",content:function(){B.find("canvas").remove();if(x){B.append(x);B.find("div").hide()}else{B.find("div").show()}return B},placement:"auto bottom",trigger:"manual hover"});
var J={};var A=true;var E=(new o.Button(new o.Icon("cloud-upload"),null,"primary")).click(function(){s()});var v=(new o.Button(new o.Icon("remove"))).click(function(){if($(this).hasClass("disabled")){return
}if(w==2){J.abort()}r()});I.append(E);I.append(v);t.fileupload(D).on("fileuploadadd",function(L,K){u()}).on("fileuploadprocessalways",function(N,M){J=M;var K=M.index;var L=M.files[K];if(!L){return r()}if(L.preview){x=L.preview;
G.popover("show")}if(L.error){x="上传失败";G.popover("show")}else{u()}}).on("fileuploadprogressall",function(L,K){var M=parseInt(K.loaded*1000/K.total,10)/10;y.attr("progress",M)}).on("fileuploaddone",function(L,K){if(K.result&&K.result.success){z.val(K.result.url);
F.popover("show")}else{z.val(D.current);x="上传失败";G.popover("show")}r()}).on("fileuploadfail",function(L,K){x="发生网络错误，上传失败，请重试。";G.popover("show");r()});var w=0;this.doUpload=s;this.getInstance=function(){return J
};r();function s(K){if(A){return}J.submit();J.jqXHR.url=J.url;LogStandardReturn(J.jqXHR,K?K:"单个图片文件上传");q()}function r(){G.popover("hide");E.addClass("disabled");A=true;v.addClass("disabled");t.val("");
y.attr("progress",0);w=0}function u(){E.removeClass("disabled");A=false;v.removeClass("disabled");w=1}function q(){x=null;G.popover("hide");E.addClass("disabled");A=true;v.removeClass("disabled");w=2}}})(k)
})(window);